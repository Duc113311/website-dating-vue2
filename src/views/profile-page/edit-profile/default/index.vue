<template>
  <div class="w-full h-full relative bg-theme p-5" v-loading="loading">
    <div class="w-full h-full">
      <!-- Back -->
      <div class="w-full header-edit flex justify-center items-center">
        <div class="w-full flex justify-center items-center">
          <div class="w-1/4">
            <BhBack @onBackComponent="onBackEditProfile"></BhBack>
          </div>
          <div class="ml-20 w-3/4 text-xl text-white">Edit Profile</div>
        </div>
      </div>

      <div class="form-edit overflow-scroll w-full">
        <div class="w-full">
          <MyPhotos :isShowTitle="true"></MyPhotos>
        </div>

        <div
          class="flex justify-center text-center w-full mt-4 mb-4 description-no-padding"
        >
          Add video, pic or logo toget 4% closer to completing your profile and
          you may even get more likes
        </div>
        <div class="w-full mb-4">
          <BhMedia></BhMedia>
        </div>

        <!-- Smart photo -->
        <div class="w-full flex justify-center items-center">
          <div class="w-full">
            <div class="w-full style-switch">
              <div class="name text-xl">Smart Photos</div>

              <div>
                <el-switch
                  v-model="value2"
                  active-color="#FB5D65"
                  inactive-color="#5F6A86"
                >
                </el-switch>
              </div>
            </div>
            <div class="w-full p-3 bh-describe">
              Smart photos continiously tests all your profile photos to find
              the best one
            </div>
          </div>
        </div>

        <!-- About -->

        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>INTEREST</div>
              <div v-if="listDataInterests.length === 0">+3%</div>
            </div>
            <div class="w-full flex style-form">
              <div class="flex justify-between w-full">
                <div class="bh-item-title style-inter-setting relative">
                  <div class="w-full flex justify-center items-center">
                    <div class="w-full text-ellipsis whitespace-nowrap">
                      <span
                        :id="index"
                        class="mr-3 mb-3 text-white border-interest"
                        v-for="(item, index) in listDataInterests"
                        :key="index"
                      >
                        {{ item }}
                      </span>
                    </div>
                  </div>
                  <div class="bg-interest absolute h-full w-full"></div>
                </div>
                <div
                  class="mr-5 flex items-center"
                  @click="onShowPopupInterest()"
                >
                  <i class="fa-solid fa-chevron-right bh-chevron-right"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Interests -->

        <!-- life style -->
        <div class="w-full flex justify-center items-center">
          <div class="w-full relative">
            <div class="w-full flex justify-between p-3 bh-title">
              <div class="">LIFE STYLE</div>
              <div v-if="completeLifeStyle">+22%</div>
            </div>

            <div class="w-full bg-life">
              <div class="w-full item-life">
                <div class="w-6/12 bh-item-title">Zodiac</div>
                <div class="flex w-6/12 justify-end">
                  <div class="flex">
                    <div
                      class="bh-describe whitespace-nowrap mr-3 overflow-hidden"
                    >
                      {{ zodiacParam }}
                    </div>
                    <div class="cursor-pointer" @click="onShowFormLife">
                      <i
                        class="fa-solid bh-chevron-right cursor-pointer fa-chevron-right"
                      ></i>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-full item-life">
                <div class="w-6/12 bh-item-title">Pets free</div>
                <div class="flex w-6/12 justify-end">
                  <div class="flex">
                    <div
                      class="bh-describe whitespace-nowrap mr-3 overflow-hidden"
                    >
                      {{ petsParam }}
                    </div>
                    <div class="cursor-pointer">
                      <i
                        class="fa-solid bh-chevron-right cursor-pointer fa-chevron-right"
                      ></i>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-full item-life">
                <div class="w-6/12 bh-item-title">Education</div>
                <div class="flex w-6/12 justify-end">
                  <div class="flex">
                    <div
                      class="bh-describe whitespace-nowrap mr-3 overflow-hidden"
                    >
                      {{ educationParam }}
                    </div>
                    <div class="cursor-pointer">
                      <i
                        class="fa-solid bh-chevron-right cursor-pointer fa-chevron-right"
                      ></i>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-full item-life">
                <div class="w-6/12 bh-item-title">Smocking smoker</div>
                <div class="flex w-6/12 justify-end">
                  <div class="flex">
                    <div
                      class="bh-describe whitespace-nowrap mr-3 overflow-hidden"
                    >
                      {{ smokeParam }}
                    </div>
                    <div class="cursor-pointer">
                      <i
                        class="fa-solid bh-chevron-right cursor-pointer fa-chevron-right"
                      ></i>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-full item-life">
                <div class="w-6/12 bh-item-title">Character</div>
                <div class="flex w-6/12 justify-end">
                  <div class="flex">
                    <div
                      class="bh-describe whitespace-nowrap mr-3 overflow-hidden"
                    >
                      {{ personalityParam }}
                    </div>
                    <div class="cursor-pointer">
                      <i
                        class="fa-solid bh-chevron-right cursor-pointer fa-chevron-right"
                      ></i>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-full item-life-end">
                <div class="w-6/12 bh-item-title">Dietary Preferences</div>
                <div class="flex w-6/12 justify-end">
                  <div class="flex">
                    <div
                      class="bh-describe whitespace-nowrap mr-3 overflow-hidden"
                    >
                      {{ preferencesParam }}
                    </div>
                    <div class="cursor-pointer">
                      <i
                        class="fa-solid bh-chevron-right cursor-pointer fa-chevron-right"
                      ></i>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Job title -->
        <!-- <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>JOB TITLE</div>
              <div>+3%</div>
            </div>
            <div class="w-full">
              <el-input placeholder="Job title" v-model="nameJob"></el-input>
            </div>
          </div>
        </div> -->
        <!-- Company -->
        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>JOB TITLE</div>
              <div v-if="nameJobTitle.length === 0">+3%</div>
            </div>
            <div class="w-full">
              <el-input
                placeholder="Add job title"
                v-model="nameJobTitle"
                @input="onInputJobTitle()"
                @change="onChangeJobTitle"
              ></el-input>
            </div>
          </div>
        </div>
        <!-- Job title -->
        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>SCHOOL</div>
              <div v-if="nameSchool.length === 0">+3%</div>
            </div>
            <div class="w-full">
              <el-input
                placeholder="Add university"
                v-model="nameSchool"
                @input="onInputSchool()"
                @change="onChangeSchool()"
              ></el-input>
            </div>
          </div>
        </div>
        <!-- Job title -->
        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>LIVING IN</div>
              <div v-if="nameLiving.length === 0">+3%</div>
            </div>
            <div class="w-full">
              <el-input
                placeholder="Add city"
                v-model="nameLiving"
                @input="onInputLiving()"
                @change="onChangeLiving()"
              ></el-input>
            </div>
          </div>
        </div>

        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>SHOW INSTAGRAM PHOTOS</div>
              <div>+3%</div>
            </div>
            <div class="w-full flex style-form">
              <div class="">
                <img
                  src="@/assets/icon/ic_instagram.svg"
                  width="30"
                  alt=""
                  srcset=""
                />
              </div>
              <div class="flex justify-between w-full p-5">
                <div class="bh-item-title">Connect Instgram</div>
                <div>
                  <i class="fa-solid fa-chevron-right bh-chevron-right"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>MY ANTHEM</div>
              <div>+3%</div>
            </div>
            <div class="w-full flex style-form">
              <div class="flex justify-between w-full">
                <div class="bh-item-title">Choose an Anthem</div>
                <div class="mr-5">
                  <i class="fa-solid fa-chevron-right bh-chevron-right"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>MY TOP SPOTIFY ARTISTS</div>
              <div>+3%</div>
            </div>
            <div class="w-full flex style-form">
              <div class="">
                <img
                  src="@/assets/icon/ic_spotify.svg"
                  width="30"
                  alt=""
                  srcset=""
                />
              </div>
              <div class="flex justify-between w-full p-5">
                <div class="bh-item-title">Connect Spotify</div>
                <div>
                  <i class="fa-solid fa-chevron-right bh-chevron-right"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex justify-between bh-title p-3">
              <div>GENDER</div>
            </div>
            <div class="w-full flex items-center">
              <div class="w-full style-bg-common">
                <div
                  class="flex justify-between w-full bd-input pb-3 pt-3"
                  @click="onChangeGender(`men`)"
                >
                  <div class="bh-item-title">Men</div>
                  <div v-if="showGenderUser === `men`">
                    <img src="@/assets/icon/ic_checked.svg" alt="" srcset="" />
                  </div>
                </div>

                <div
                  class="flex justify-between w-full pb-3 pt-3"
                  @click="onChangeGender(`women`)"
                >
                  <div class="bh-item-title">Women</div>
                  <div v-if="showGenderUser === 'women'">
                    <img src="@/assets/icon/ic_checked.svg" alt="" srcset="" />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full flex items-center">
          <div class="w-full">
            <div class="w-full flex bh-title p-3 items-center">
              <div>CONTROL PROFILE</div>
              <div class="ml-3">
                <div class="style-package">Sliver package</div>
              </div>
            </div>
            <div class="w-full flex items-center">
              <div class="w-full style-bg-common">
                <div class="flex justify-between w-full p-2">
                  <div class="bh-item-title">Don't show my age</div>
                  <div>
                    <el-switch
                      v-model="showValueAge"
                      active-color="#FB5D65"
                      inactive-color="#5F6A86"
                      @change="onChangeValueAge()"
                    >
                    </el-switch>
                  </div>
                </div>
                <div class="flex justify-center w-full items-center">
                  <div class="br-bottom"></div>
                </div>
                <div class="flex justify-between w-full p-2">
                  <div class="bh-item-title">Don't show my distance</div>
                  <div>
                    <el-switch
                      v-model="showDistance"
                      active-color="#FB5D65"
                      inactive-color="#5F6A86"
                      @change="onChangeValueDistance()"
                    >
                    </el-switch>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="w-full">
        <Footer></Footer>
      </div>
    </div>
    <div
      v-show="isShowLifeStyle"
      class="w-full h-full absolute top-0 left-0 z-30"
    >
      <FormLifeStyle
        @onClickCancelLife="onClickCancelLife"
        @onClickSaveLife="onClickSaveLife"
      ></FormLifeStyle>
    </div>

    <div
      v-show="isShowInterest"
      class="w-full h-full absolute top-0 left-0 z-30"
    >
      <FormInterests
        @onClickHideInterest="onClickHideInterest"
        @onClickSaveInterest="onClickSaveInterest"
      ></FormInterests>
    </div>
  </div>
</template>

<script>
import Footer from "../../../../components/layout/footer-home/footer";
import MyPhotos from "../../../../components/create-profiles/my-self/my-photos";
import BhBack from "../../../../components/bh-element-ui/button/bh-back";
import BhMedia from "../../../../components/bh-element-ui/button/bh-media.vue";

import { mapActions, mapGetters, mapMutations } from "vuex";
export default {
  components: {
    Footer,
    MyPhotos,
    BhBack,
    BhMedia,
  },
  name: "edit-profile",

  data() {
    return {
      valueAge: false,
      valueDistance: false,
      value2: true,
      nameJob: "",
      valDefaultAbout: "",
      completeAbout: false,
      dialogTableVisible: false,

      isShowLifeStyle: false,

      completeJobTitle: false,
      completeSchool: false,
      completeLiving: false,

      nameJobTitle:
        this.$store.state.userModule.user_profile?.profiles?.jobTitle,
      nameSchool:
        this.$store.state.userModule.user_profile?.profiles?.university,
      nameLiving: this.$store.state.userModule.user_profile?.profiles?.address
        ? this.$store.state.userModule.user_profile?.profiles?.address
        : "",
      nameDefault: "Trống",
      nameSmoke: "Trống",
      namePets: "Trống",
      namePersonality: "Trống",
      nameEducation: "Trống",
      namePreferences: "Trống",
      genderSetting: 0,

      loading: false,

      isShowInterest: false,
      valShowAge: false,
      // showGender: 0,
    };
  },

  computed: {
    ...mapGetters({
      nameShowAge: "showAge",
      nameShowDistance: "showDistance",
    }),

    completeLifeStyle() {
      if ((this.zodiacParam || this.petsParam) !== "Trống") {
        return false;
      }

      return true;
    },

    // Show age
    showValueAge: {
      get() {
        const age = this.nameShowAge;

        return age;
      },
      set(newName) {
        return newName;
      },
    },

    // Show Distance
    showDistance: {
      get() {
        const age = this.nameShowDistance;

        return age;
      },
      set(newName) {
        return newName;
      },
    },

    listDataInterests() {
      const interestData =
        this.$store.state.userModule.user_profile?.profiles.interests;
      return interestData ? interestData : [];
    },

    showGenderUser() {
      const gender = this.$store.state.userModule.user_profile?.profiles.gender;

      return gender;
    },

    // showGender: {
    //   get() {
    //     const gender = this.$store.state.userModule.user_profile?.gender;

    //     return gender ? gender : this.genderSetting;
    //   },
    //   set(newValue) {
    //     // Note: we are using destructuring assignment syntax here.
    //     this.genderSetting = newValue;
    //   },
    // },

    valueAbout: {
      // getter
      get() {
        const about =
          this.$store.state.userModule.user_profile?.profiles?.about;

        return about ? about : this.valDefaultAbout;
      },
      // setter
      set(newValue) {
        // Note: we are using destructuring assignment syntax here.
        this.valDefaultAbout = newValue;
      },
    },

    valueJobTitle: {
      get() {
        const about =
          this.$store.state.userModule.user_profile?.profiles?.jobTitle;

        return about ? about : this.nameJobTitle;
      },
      // setter
      set(newValue) {
        // Note: we are using destructuring assignment syntax here.
        this.nameJobTitle = newValue;
      },
    },

    valueSchool: {
      get() {
        const about =
          this.$store.state.userModule.user_profile?.profiles?.university;

        return about ? about : this.nameSchool;
      },
      // setter
      set(newValue) {
        // Note: we are using destructuring assignment syntax here.
        this.nameSchool = newValue;
      },
    },

    valueLiving: {
      get() {
        const about =
          this.$store.state.userModule.user_profile?.profiles?.address;
        return about ? about : this.nameLiving;
      },
      // setter
      set(newValue) {
        // Note: we are using destructuring assignment syntax here.
        this.nameLiving = newValue;
      },
    },

    zodiacParam() {
      const zodiacData = this.$store.state.userModule.profileLife.zodiac;

      return zodiacData ? zodiacData : this.nameDefault;
    },

    petsParam() {
      const petsFreeData = this.$store.state.userModule.profileLife.pet;

      return petsFreeData ? petsFreeData : this.nameDefault;
    },

    educationParam() {
      const educationData = this.$store.state.userModule.profileLife.education;

      return educationData ? educationData : this.nameDefault;
    },

    personalityParam() {
      const personalityData =
        this.$store.state.userModule.profileLife.personality;

      return personalityData ? personalityData : this.nameDefault;
    },

    smokeParam() {
      const smokeData = this.$store.state.userModule.profileLife.smoking;

      return smokeData ? smokeData : this.nameDefault;
    },

    preferencesParam() {
      const personalityData =
        this.$store.state.userModule.profileLife.dietaryPreference;

      return personalityData ? personalityData : this.nameDefault;
    },
  },

  methods: {
    ...mapMutations([
      "setShowGenderSetting",
      "setGender",
      "setShowAge",
      "setAbout",
      "setShowDistance",
      "setLifeStyleUser",
      "setJobTitle",
      "setSchool",
    ]),

    ...mapActions(["updateProfileUser"]),
    onChangeValueAge() {
      const age = this.$store.state.userModule.user_profile.profiles.showAge;
      if (age) {
        this.setShowAge(false);
      } else {
        this.setShowAge(true);
      }
    },

    onChangeValueDistance() {
      const distance =
        this.$store.state.userModule.user_profile.profiles.showDistance;
      if (distance) {
        this.setShowDistance(false);
      } else {
        this.setShowDistance(true);
      }
    },
    onChangeGender(val) {
      this.setGender(val);
    },

    onShowPopupInterest() {
      this.isShowInterest = true;
    },

    onClickSaveInterest(val) {
      this.isShowInterest = val;
    },

    onClickHideInterest(val) {
      this.isShowInterest = val;
    },

    onBackEditProfile(val) {
      console.log(val);
      this.loading = true;

      const profile = this.$store.state.userModule.user_profile;
      // profile.about=this.valueAbout

      this.updateProfileUser(profile.profiles);

      console.log(profile);
      setTimeout(() => {
        this.loading = false;
        this.$router.push({ path: "/profile" });
      }, 1000);
    },

    onChangeSaveAbout() {
      // const userProfile = this.$store.state.userModule.user_profile;
      this.setAbout(this.valueAbout);
      // this.updateProfileUser(userProfile.profiles);
    },

    /**
     * Action update about
     */
    onChangeAbout() {
      if (this.valueAbout === "") {
        this.completeAbout = false;
      } else {
        this.completeAbout = true;
        // this.updateProfileUser({ about: this.valueAbout });
      }
    },

    onClickCancelLife(val) {
      this.isShowLifeStyle = val;
    },
    onClickSaveLife(val) {
      this.isShowLifeStyle = val;

      if (
        (this.zodiacParam ||
          this.petsParam ||
          this.educationParam ||
          this.personalityParam ||
          this.preferencesParam ||
          this.smokeParam) !== "Trống"
      ) {
        this.completeAbout = true;
      } else {
        this.completeAbout = false;
      }
    },

    onShowFormLife() {
      this.isShowLifeStyle = true;
    },

    /**
     * Bắt sự kiện khi nhập
     */
    onInputJobTitle() {
      if (this.valueJobTitle === "") {
        this.completeJobTitle = false;
      } else {
        this.completeJobTitle = true;
      }
    },

    /**
     * Bắt sự kiện khi đã nhập xong
     */
    onChangeJobTitle() {
      this.setJobTitle(this.valueJobTitle);
    },

    /**
     * Bắt sự kiện khi nhập
     */
    onInputSchool() {
      if (this.valueSchool === "") {
        this.completeSchool = false;
      } else {
        this.completeSchool = true;
      }
    },

    /**
     * Bắt sự kiện khi nhập xong
     */
    onChangeSchool() {
      this.setSchool(this.valueSchool);
    },
    onInputLiving() {
      if (this.valueLiving === "") {
        this.completeLiving = false;
      } else {
        this.completeLiving = true;
      }
    },
    onChangeLiving() {
      this.setAddress(this.valueLiving);
    },
  },

  async created() {},

  mounted() {},
};
</script>

<style lang="css">
.bg-theme {
  background-color: #242a38;
}

.header-edit {
  height: 8%;
}

.form-edit {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none;
  overflow-y: scroll; /* Add the ability to scroll */
  height: 84%;
}

.form-edit::-webkit-scrollbar {
  display: none;
}

.style-switch {
  display: flex;
  justify-content: space-between;
  padding: 15px;
  border-radius: 10px;
}

.el-textarea__inner {
  min-height: 140px !important;
  height: 134px !important;
  background-color: rgb(73, 80, 99) !important;
  border: 1px solid rgb(73, 80, 99) !important;
  border-radius: 10px !important;
  font-size: 17px !important;
  padding: 12px !important;
  color: #ffffff !important;
}

.item-life {
  display: flex;
  /* padding: 12px; */
  border-bottom: 1px solid #616781;
  padding-bottom: 15px;
  padding-top: 15px;
}
.item-life-end {
  display: flex;
  /* padding: 12px; */
  padding-bottom: 15px;
  padding-top: 15px;
}

.el-input__inner {
  border-radius: 10px !important;
  padding: 13px !important;
  font-size: 15px !important;
  height: 50px !important;
}

.style-bg-common {
  align-items: center;
  padding: 10px;
  border-radius: 10px;
}

.style-package {
  padding: 5px;
  width: 138px;
  display: flex;
  justify-content: center;
  border: 1px solid #8fada5;
  border-radius: 4px;
  background-color: #8fada5;
  color: #ffffff;
}

.h-data-life::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.h-data-life {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

.el-loading-spinner {
  display: flex;
  justify-content: center;
}

.style-inter-setting {
  width: 28rem;
  overflow: hidden;
  height: 50px;
  display: flex;
  align-items: center;
}

.bg-interest {
  background: rgb(73, 80, 99);
  background: linear-gradient(
    270deg,
    rgba(73, 80, 99, 1) 7%,
    rgba(240, 233, 233, 0) 22%
  );
}
</style>
